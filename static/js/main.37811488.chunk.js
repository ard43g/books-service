(this["webpackJsonpbooks-service"]=this["webpackJsonpbooks-service"]||[]).push([[0],{11:function(e,t,o){e.exports={books__wrapper:"books_books__wrapper__ukusG",book__wrapper:"books_book__wrapper__S2SgS",book__image:"books_book__image__3rqbX",book__categories:"books_book__categories__1UIo5",book__title:"books_book__title__1u_P9",book__authors:"books_book__authors__2sMXH",book__date:"books_book__date__3Ut3z"}},18:function(e,t,o){e.exports={modal__wrapper:"modal_modal__wrapper__O2MPa",modal__body:"modal_modal__body__SFa8J",modal__close:"modal_modal__close__3B7nc"}},19:function(e,t,o){e.exports={spinner__wrapper:"spinner_spinner__wrapper__21sBE",spinner__block:"spinner_spinner__block__3iO4B",ldio__v41ylq3usio:"spinner_ldio__v41ylq3usio__1D5ba","ldio-v41ylq3usio":"spinner_ldio-v41ylq3usio__2k0Kh",loadingio__spinner__magnify__br2a0iyrb4a:"spinner_loadingio__spinner__magnify__br2a0iyrb4a__1NWRX"}},25:function(e,t,o){e.exports={button:"button-main_button__3ikAj"}},26:function(e,t,o){e.exports={search__wrapper:"search-panel_search__wrapper__NPP-8",search__input:"search-panel_search__input__1LDSM"}},29:function(e,t,o){e.exports={search__container:"search-container_search__container__PpRLb",search__filter:"search-container_search__filter__23PTE"}},33:function(e,t,o){e.exports={filter__select:"filter-panel_filter__select__3CeIw"}},34:function(e,t,o){e.exports={title__main:"title_title__main__28_6v"}},35:function(e,t,o){e.exports={counter:"counter_counter__cvx5j"}},46:function(e,t,o){},54:function(e,t,o){},55:function(e,t,o){"use strict";o.r(t);var n=o(0),a=o(12),r=o.n(a),c=(o(46),o(15)),i=o(4),s=o(10),u=o(14),_=o.n(u),l=o(21),b=o(30),d=o(2),j={requestBooks:function(e,t,o,n){return Object(l.a)(_.a.mark((function a(){return _.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("".concat("https://www.googleapis.com/books/v1/","volumes?q=").concat(e).concat(t,"&maxResults=30&orderBy=").concat(o,"&startIndex=").concat(n)).then((function(e){return e.json()}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),a)})))()}},f="SET_TOTAL_COUNT",p="SET_BOOKS",O="SET_ACTIVE_CATEGORIES",k="SET_ACTIVE_SORT",v="SET_LOAD_BOOK_COUNT",m="UPDATE_BOOKS",h="SET_LOADING",g="SET_ERROR",x="SET_NOTIFICATION",C="SET_PAGE_BOOK",S="ON_CLOSE_MODAL",B="DELETE_BOOKSHELF",y="DELETE_ACTIVE_BOOK",N="SET_CURRENT_POSITION",w={loading:!1,error:!1,notification:null,stepPage:30,subjects:["all","art","biography","computers","history","medical","poetry"],sort:["relevance","newest"],books:[],totalCount:0,activeCategories:"all",activeSort:"relevance",activeBook:null,loadBooksCount:0,currentPosition:0},I=function(e){return{type:h,loading:e}},P=function(e){return{type:g,error:e}},E=function(e){return{type:x,notification:e}},T=function(e){return{type:f,count:e}},L=function(e){return{type:p,items:e}},A=function(e){return{type:m,items:e}},D=function(){return{type:B}},q=function(e){return{type:N,position:e}},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return Object(d.a)(Object(d.a)({},e),{},{loading:t.loading});case g:return Object(d.a)(Object(d.a)({},e),{},{error:t.error});case x:return Object(d.a)(Object(d.a)({},e),{},{notification:t.notification});case f:return Object(d.a)(Object(d.a)({},e),{},{totalCount:t.count});case p:return Object(d.a)(Object(d.a)({},e),{},{books:t.items,loadBooksCount:t.items.length});case O:return Object(d.a)(Object(d.a)({},e),{},{activeCategories:t.categories});case k:return Object(d.a)(Object(d.a)({},e),{},{activeSort:t.activeSort});case m:return Object(d.a)(Object(d.a)({},e),{},{books:[].concat(Object(b.a)(e.books),Object(b.a)(t.items))});case v:return Object(d.a)(Object(d.a)({},e),{},{loadBooksCount:t.count});case C:var o=t.activeBook,n=e.books.findIndex((function(e){return e.id===o}));return Object(d.a)(Object(d.a)({},e),{},{activeBook:e.books[n]});case S:return Object(d.a)(Object(d.a)({},e),{},{notification:null,error:!1});case B:return Object(d.a)(Object(d.a)({},e),{},{books:[],totalCount:0});case N:return Object(d.a)(Object(d.a)({},e),{},{currentPosition:t.position});case y:return Object(d.a)(Object(d.a)({},e),{},{activeBook:null});default:return e}},K=o(33),M=o.n(K),U=o(1),F=Object(n.memo)((function(e){var t=e.value,o=e.name,n=e.onSetCategories,a=e.onSetSort;return Object(U.jsx)("select",{className:M.a.filter__select,type:"select",name:o,onChange:function(e){"subjects"===e.target.name?n(e.target.value):"date"===e.target.name&&a(e.target.value)},children:t.map((function(e){return Object(U.jsx)("option",{value:e,children:e},e)}))})})),G=o(18),X=o.n(G),J=function(e){var t=e.onCloseModal,o=e.message,n=e.critical;return document.body.style.overflow="hidden",r.a.createPortal(Object(U.jsx)("div",{className:X.a.modal__wrapper,children:Object(U.jsxs)("div",{className:X.a.modal__body,children:[!n&&Object(U.jsx)("div",{className:X.a.modal__close,onClick:function(){document.body.style.overflow="auto",t()},children:"X"}),Object(U.jsxs)("div",{className:X.a.modal__text,children:[" ",o]})]})}),document.body)},z=o(31),Q=o(41),V=o(25),H=o.n(V),W=["name","disabled"],Y=function(e){var t=e.name,o=e.disabled,n=Object(Q.a)(e,W);if("load"===t){var a=n.loadBooksCount,r=n.setLoadBooksCount,c=n.totalCount,i=n.stepPage;return Object(U.jsx)(U.Fragment,{children:a>0&&a<c&&Object(U.jsx)("button",{onClick:function(){r(a+i)},className:H.a.button,children:"Load more"})})}if("search"===t)return Object(U.jsx)("button",{className:H.a.button,disabled:o,children:"\u041f\u043e\u0438\u0441\u043a"})},Z=o(26),$=o.n(Z),ee=function(e){var t=e.onSearchBook,o=e.activeCategories,a=e.activeSort,r=e.loadBooksCount,c=e.loading,s=e.stepPage,u=e.booksInShelfCount,_=Object(n.useState)(""),l=Object(z.a)(_,2),b=l[0],d=l[1],j=Object(n.useState)(r),f=Object(z.a)(j,2),p=f[0],O=f[1];var k=Object(i.f)();return Object(n.useEffect)((function(){O(r),p!==r&&r>s&&t(b,o,a,u,!0)}),[r]),Object(U.jsx)("div",{className:$.a.search__wrapper,children:Object(U.jsxs)("form",{onSubmit:function(e){e.preventDefault(),k.push("/"),t(b,o,a,0,!1)},children:[Object(U.jsx)("input",{className:$.a.search__input,type:"text",onChange:function(e){d(e.target.value)},value:b}),Object(U.jsx)(Y,{disabled:!b||c,name:"search"})]})})},te=o(34),oe=o.n(te),ne=function(e){var t=e.title;return Object(U.jsx)("h1",{className:oe.a.title__main,children:t})},ae=function(e){return e.subjects},re=function(e){return e.sort},ce=function(e){return e.books},ie=function(e){return e.activeBook},se=function(e){return e.totalCount},ue=function(e){return e.activeCategories},_e=function(e){return e.activeSort},le=function(e){return e.loadBooksCount},be=function(e){return e.loading},de=function(e){return e.books.length},je=function(e){return e.stepPage},fe=function(e){return e.notification},pe=function(e){return e.currentPosition},Oe=function(e){return e.error},ke=o(29),ve=o.n(ke),me=Object(s.b)((function(e){return{subjects:ae(e),sort:re(e),activeCategories:ue(e),activeSort:_e(e),loadBooksCount:le(e),loading:be(e),stepPage:je(e),notification:fe(e),error:Oe(e),booksInShelfCount:de(e)}}),(function(e){return{onSearchBook:function(t,o,n,a,r){e(function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r="all"===t?"":"+subject:".concat(t),c="intitle:".concat(e);return function(){var e=Object(l.a)(_.a.mark((function e(t){var i;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(I(!0)),e.prev=1,e.next=4,j.requestBooks(c,r,o,n);case 4:0===(i=e.sent).totalItems&&(t(P(!0)),t(E("\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e")),t(D()),t(I(!1))),0===i.totalItems||i.error||(t(T(i.totalItems)),a?(t(A(i.items)),t(I(!1))):(t(q(0)),t(L(i.items)),t(I(!1)))),i.error&&(t(E(i.error.message)),t(I(!1)),t(P(!0))),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),t(P(!0)),t(I(!1)),t(E("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"));case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()}(t,o,n,a,r))},onSetCategories:function(t){e(function(e){return{type:O,categories:e}}(t))},onSetSort:function(t){e({type:k,activeSort:t})},onCloseModal:function(){e({type:S})}}}))((function(e){return Object(U.jsxs)("div",{className:ve.a.search__container,children:[Object(U.jsx)(ne,{title:"Library"}),Object(U.jsx)(ee,{onSearchBook:e.onSearchBook,activeCategories:e.activeCategories,activeSort:e.activeSort,loadBooksCount:e.loadBooksCount,loading:e.loading,stepPage:e.stepPage,booksInShelfCount:e.booksInShelfCount}),Object(U.jsxs)("div",{className:ve.a.search__filter,children:[Object(U.jsx)(F,{value:e.subjects,name:"subjects",onSetCategories:e.onSetCategories}),Object(U.jsx)(F,{value:e.sort,name:"date",onSetSort:e.onSetSort})]}),e.error&&Object(U.jsx)(J,{message:e.notification,onCloseModal:e.onCloseModal})]})})),he=o(11),ge=o.n(he),xe=Object(n.memo)((function(e){var t=e.items,o=e.setBookPage,a=e.currentPosition,r=e.setCurrentPosition,c=e.setLoading,s=e.activeBook,u=Object(i.f)();function _(e){o(e),r(window.pageYOffset),u.push("/book/".concat(e))}return Object(n.useEffect)((function(){0===a||s||(window.scrollTo(0,a),c(!1))}),[a]),t&&0!==t.length?Object(U.jsx)("div",{className:ge.a.books__wrapper,children:t.map((function(e,t){var o,n,a=(null===(o=e.volumeInfo.authors)||void 0===o?void 0:o.length)>1?e.volumeInfo.authors.reduce((function(e,t){return"".concat(e,", ").concat(t)})):e.volumeInfo.authors;return Object(U.jsxs)("div",{className:ge.a.book__wrapper,children:[Object(U.jsx)("div",{className:ge.a.book__image,children:Object(U.jsx)("img",{src:(null===(n=e.volumeInfo.imageLinks)||void 0===n?void 0:n.smallThumbnail)||"",alt:e.volumeInfo.title||"",onClick:function(){return _(e.id)}})}),Object(U.jsx)("div",{className:ge.a.book__categories,children:e.volumeInfo.categories||""}),Object(U.jsx)("h2",{className:ge.a.book__title,onClick:function(){return _(e.id)},children:e.volumeInfo.title||""}),a&&Object(U.jsx)("div",{className:ge.a.book__authors,children:a})]},t)}))}):null})),Ce=o(35),Se=o.n(Ce),Be=function(e){var t=e.count;return Object(U.jsxs)("div",{className:Se.a.counter,children:["\u041d\u0430\u0439\u0434\u0435\u043d\u043e: ",Object(U.jsx)("span",{children:t})]})},ye=o(19),Ne=o.n(ye),we=function(){return Object(U.jsx)("div",{className:Ne.a.spinner__wrapper,children:Object(U.jsx)("div",{className:Ne.a.spinner__block,children:Object(U.jsx)("div",{className:Ne.a.loadingio__spinner__magnify__br2a0iyrb4a,children:Object(U.jsx)("div",{className:Ne.a.ldio__v41ylq3usio,children:Object(U.jsx)("div",{children:Object(U.jsxs)("div",{children:[Object(U.jsx)("div",{}),Object(U.jsx)("div",{})]})})})})})})},Ie=Object(s.b)((function(e){return{books:ce(e),totalCount:se(e),loadBooksCount:le(e),loading:be(e),stepPage:je(e),currentPosition:pe(e),activeBook:ie(e)}}),(function(e){return{setLoadBooksCount:function(t){e(function(e){return{type:v,count:e}}(t))},setBookPage:function(t){e(function(e){return{type:C,activeBook:e}}(t))},setCurrentPosition:function(t){e(q(t))},setLoading:function(t){e(I(t))}}}))((function(e){return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(Be,{count:e.totalCount}),e.loading&&Object(U.jsx)(we,{}),Object(U.jsx)(xe,{items:e.books,setBookPage:e.setBookPage,currentPosition:e.currentPosition,setCurrentPosition:e.setCurrentPosition,setLoading:e.setLoading,activeBook:e.activeBook}),Object(U.jsx)(Y,{name:"load",setLoadBooksCount:e.setLoadBooksCount,loadBooksCount:e.loadBooksCount,totalCount:e.totalCount,stepPage:e.stepPage})]})})),Pe=o(9),Ee=o.n(Pe),Te=function(e){var t=e.click,o=e.image,a=e.categories,r=e.title,c=e.subtitle,i=e.authors,s=e.date,u=e.descr;return Object(n.useEffect)((function(){window.scrollTo(0,300)}),[]),Object(U.jsxs)("div",{className:Ee.a.book__wrapper,children:[Object(U.jsx)("button",{className:Ee.a.button__back,onClick:function(){return t()},children:Object(U.jsx)("span",{children:"X"})}),Object(U.jsx)("div",{className:Ee.a.book__image,children:Object(U.jsx)("img",{src:o,alt:r})}),Object(U.jsxs)("div",{className:Ee.a.book__descr,children:[Object(U.jsx)("div",{className:Ee.a.book__categories,children:a}),Object(U.jsx)("h2",{className:Ee.a.book__title,children:r}),Object(U.jsx)("h3",{className:Ee.a.book__subtitle,children:c}),Object(U.jsx)("div",{className:Ee.a.book__authors,children:i}),Object(U.jsxs)("div",{className:Ee.a.book__date,children:["Published date: ",s]}),u&&Object(U.jsx)("div",{className:Ee.a.book__description,children:u})]})]})},Le=Object(s.b)((function(e){return{activeBook:ie(e)}}),(function(e){return{setLoading:function(t){e(I(t))},deleteActiveBook:function(){e({type:y})}}}))((function(e){var t,o,n,a,r=e.activeBook,c=e.setLoading,s=e.deleteActiveBook,u=Object(i.f)();if(""!==u.location.pathname&&!r)return Object(U.jsx)(i.a,{to:"/"});var _=r.volumeInfo.title||"",l=r.volumeInfo.subtitle||"",b=(null===(t=r.volumeInfo.imageLinks)||void 0===t?void 0:t.thumbnail)||"",d=r.volumeInfo.categories||"",j=(null===(o=r.volumeInfo)||void 0===o||null===(n=o.authors)||void 0===n?void 0:n.length)>1?r.volumeInfo.authors.reduce((function(e,t){return"".concat(e,", ").concat(t)})):r.volumeInfo.authors||"",f=r.volumeInfo.publishedDate||"",p=(null===(a=r.searchInfo)||void 0===a?void 0:a.textSnippet)||"";return Object(U.jsx)(Te,{click:function(){c(!0),s(),u.push("/")},image:b,categories:d,title:_,subtitle:l,authors:j,date:f,descr:p})}));o(54);var Ae=function(){return Object(U.jsxs)(c.a,{basename:"/",children:[Object(U.jsx)(me,{}),Object(U.jsx)(i.b,{exact:!0,path:"/",component:Ie}),Object(U.jsx)(i.b,{path:"/book/:id",component:Le})]})},De=o(32),qe=o(36),Re=Object(De.b)(R,Object(De.a)(qe.a)),Ke=o(37),Me=o(38),Ue=o(40),Fe=o(39),Ge=function(e){Object(Ue.a)(o,e);var t=Object(Fe.a)(o);function o(){var e;Object(Ke.a)(this,o);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={error:!1},e}return Object(Me.a)(o,[{key:"componentDidCatch",value:function(){console.log("catch"),this.setState({error:!0})}},{key:"render",value:function(){return this.state.error?Object(U.jsx)(J,{message:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a...",critical:!0}):this.props.children}}]),o}(n.Component);r.a.render(Object(U.jsx)(Ge,{children:Object(U.jsx)(s.a,{store:Re,children:Object(U.jsx)(Ae,{})})}),document.getElementById("root"))},9:function(e,t,o){e.exports={book__wrapper:"book-page_book__wrapper__26OOQ",book__image:"book-page_book__image__1mGzz",book__descr:"book-page_book__descr__2AeKQ",book__title:"book-page_book__title__3gkF9",book__subtitle:"book-page_book__subtitle__1IqE5",book__categories:"book-page_book__categories__GAuOU",book__authors:"book-page_book__authors__2QpDC",book__date:"book-page_book__date__1KeJy",book__description:"book-page_book__description__1i0hT",button__back:"book-page_button__back__1lc30"}}},[[55,1,2]]]);
//# sourceMappingURL=main.37811488.chunk.js.map